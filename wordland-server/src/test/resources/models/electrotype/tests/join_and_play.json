[
  {
    "comment": "list available rooms",
    "request": { "uri": "rooms" },
    "response": {
      "store": "rooms",
      "check": [
        {"condition": "json.length > 0"}
      ]
    }
  },

  {
    "comment": "join room",
    "request": {
      "uri": "rooms/{{rooms.0.name}}/join",
      "entity": {
        "name": "Joe Smith"
      }
    },
    "response": {
      "store": "player",
      "sessionName": "player",
      "session": "apiKey",
      "check": [
        {"condition": "json.name == 'Joe Smith'"},
        {"condition": "json.id != null"}
      ]
    }
  },

  {
    "comment": "player requests more board state, verify updates",
    "request": {
      "uri": "rooms/{{rooms.0.name}}/board"
    },
    "response": {
      "store": "board"
    }
  },

  {
    "comment": "player plays word",
    "before": "find-word-and-tiles board word1",
    "request": {
      "session": "player",
      "uri": "rooms/{{rooms.0.name}}/play",
      "entity": {
        "room": "{{rooms.0.name}}",
        "stateChange": "word_played",
        "id": "{{player.id}}",
        "clientId": "{{player.id}}",
        "apiKey": "{{player.apiKey}}",
        "word": "{{word1.word}}",
        "tilesJson": "{{escaped_json word1.tiles}}"
      }
    }
  },

  {
    "comment": "player requests more board state, verify updates",
    "request": {
      "uri": "rooms/{{rooms.0.name}}/board"
    },
    "response": {
      "store": "board",
      "check": [
        {"condition": "json.claimedWord('{{word1.word}}')"}
      ]
    }
  },

  {
    "comment": "quit game",
    "request": {
      "uri": "rooms/{{rooms.0.name}}/quit",
      "entity": {
        "room": "{{rooms.0.name}}",
        "stateChange": "player_left",
        "id": "{{player.id}}",
        "clientId": "{{player.id}}",
        "apiKey": "{{player.apiKey}}"
      }
    },
    "response": {
      "status": 200
    }
  }
]